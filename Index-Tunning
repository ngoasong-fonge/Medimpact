SELECT
  schemaname,
  relname,
  seq_scan - idx_scan AS too_much_seq,
  CASE
    WHEN
      seq_scan - coalesce(idx_scan, 0) > 0
    THEN
      'Missing Index?'
    ELSE
      'OK'
  END,
  pg_relation_size(relname::regclass) AS rel_size, seq_scan, idx_scan
FROM
  pg_stat_all_tables
WHERE
  pg_relation_size(relname::regclass) > 80000
ORDER BY
  too_much_seq DESC, schemaname, relname;

citus=# drop role "deployadmin";
ERROR:  role "deployadmin" does not exist
CONTEXT:  while executing command on 10.13.3.51:5432
-----------------------------------------------------------------------------------------------------------------------------------------

pgbadger -f stderr -v --prefix='%m [%r] [%p]: [%l-1] user=%u,db=%d,host=%h' /opt/backup/fri_badgerlog/postgresql-2024-06-21* -o /opt/app/patroni/scripts/pgbadgerlogs/badger.2024.06.21.html

DEBUG: Processing log file: /opt/backup/fri_badgerlog/postgresql-2024-06-21_040218.log
DEBUG: Starting reading file "/opt/backup/fri_badgerlog/postgresql-2024-06-21_040218.log"..., events: 3341
DEBUG: Start parsing postgresql log at offset 0 of file "/opt/backup/fri_badgerlog/postgresql-2024-06-21_040218.log" to 10628547
DEBUG: pgBadger will use log format stderr to parse /opt/backup/fri_badgerlog/postgresql-2024-06-21_040232.log.
DEBUG: timezone not specified, using 0 seconds
DEBUG: Processing log file: /opt/backup/fri_badgerlog/postgresql-2024-06-21_040232.log
DEBUG: Starting reading file "/opt/backup/fri_badgerlog/postgresql-2024-06-21_040232.log"..., events: 3343
DEBUG: Start parsing postgresql log at offset 0 of file "/opt/backup/fri_badgerlog/postgresql-2024-06-21_040232.log" to 10635192
DEBUG: pgBadger will use log format stderr to parse /opt/backup/fri_badgerlog/postgresql-2024-06-21_040255.log.
DEBUG: timezone not specified, using 0 seconds
DEBUG: Processing log file: /opt/backup/fri_badgerlog/postgresql-2024-06-21_040255.log
DEBUG: Starting reading file "/opt/backup/fri_badgerlog/postgresql-2024-06-21_040255.log"..., events: 3348
DEBUG: Start parsing postgresql log at offset 0 of file "/opt/backup/fri_badgerlog/postgresql-2024-06-21_040255.log" to 10647967
DEBUG: pgBadger will use log format stderr to parse /opt/backup/fri_badgerlog/postgresql-2024-06-21_040312.log.
DEBUG: timezone not specified, using 0 seconds
DEBUG: Processing log file: /opt/backup/fri_badgerlog/postgresql-2024-06-21_040312.log
WARNING: can't read file /opt/backup/fri_badgerlog/postgresql-2024-06-21_040312.log, Too many open files
FATAL: cannot read log file /opt/backup/fri_badgerlog/postgresql-2024-06-21_040312.log. Too many open files
    - Error at line 18906
DEBUG: pgBadger will use log format stderr to parse /opt/backup/fri_badgerlog/postgresql-2024-06-21_040327.log.
DEBUG: timezone not specified, using 0 seconds
Error in tempfile() using template /tmp/tmp_pgbadgerXXXX.bin: Could not create temp file /tmp/tmp_pgbadgerCyAC.bin: Too many open files at /opt/app/localhome/svcpostgres/pgbadger-12.2/pgbadger line 1790.


rsync -avz --progress --partial nfonge@pv2medpg1c2:/opt/backup/pgprod1/group0/wal_archive/ nfonge@pv1medpg0c1:/opt/app/postgres-data/data/pg_wal/

rsync intelligently synchronizes files between two locations, only copying what is needed. This makes it particularly useful for repetitive file transfer tasks

