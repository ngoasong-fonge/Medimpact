[svcpostgres@pv1medpg0c1 group0]$ /opt/app/python/bin/patronictl -c /opt/app/patroni/patroni.yml list
+ Citus cluster: pgproddr1 --------+----------------+-----------+----+-----------+
| Group | Member      | Host       | Role           | State     | TL | Lag in MB |
+-------+-------------+------------+----------------+-----------+----+-----------+
|     0 | pv1medpg0c1 | 10.13.2.21 | Standby Leader | streaming | 17 |           |
|     0 | pv1medpg0c2 | 10.13.2.27 | Replica        | streaming | 17 |         0 |
|     1 | pv1medpg0w1 | 10.13.2.30 | Standby Leader | streaming | 12 |           |
|     1 | pv1medpg0w2 | 10.13.2.31 | Replica        | streaming | 12 |         0 |
|     2 | pv1medpg0w3 | 10.13.2.34 | Standby Leader | streaming | 11 |           |
|     2 | pv1medpg0w4 | 10.13.2.35 | Replica        | streaming | 11 |         0 |
+-------+-------------+------------+----------------+-----------+----+-----------+

explain select coalesce(mc.client_name, '') || ' - ' || coalesce(mc.client_code, '') as client_code , ev.orig_claim_id,STRING_AGG(eve.EXCEPTION_CODE,',') as exception_code,STRING_AGG(mec.EXCEPTION_DESC,',') as EXCEPTION_DESC
from ngmep.file_transmission ft
join ngmep.mep_client mc on mc.sender_id = ft.sender_id and now() between mc.start_date and mc.end_date
join ngmep.encounter_version ev on (ev.enc_file_transmission_id = ft.file_transmission_id and ev.sender_id=mc.sender_id and ev.encounter_ver_status='Exception')
join ngmep.encounter_ver_exception eve on ev.encounter_version_id = eve.encounter_version_id
join ngmep.mep_exception_code mec on eve.exception_code = mec.exception_code and mec.internal_external_ind = 'External' 
where ft.direction = 'Outbound'
  and ft.sender_id in ('9900004318')   and ft.created between '2023-09-26' and '2023-10-25'  GROUP BY mc.client_name, mc.client_code , ev.orig_claim_id
