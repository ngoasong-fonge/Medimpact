[databases]
db1 = host=1.1.1.1 port=5432 dbname=db1 user=db1_user
db2 = host=1.1.1.1 port=5432 dbname=db2 user=db2_user

[pgbouncer]
listen_addr = 1.1.1.1
listen_port = 3333
auth_type = md5
auth_file = /etc/pgbouncer/userlist.txt
admin_users = admin_user
pool_mode = transaction
max_client_conn = 1000
default_pool_size = 20
logfile = /var/log/pgbouncer/pgbouncer.log
pidfile = /var/log/pgbouncer/pgbouncer.pid
unix_socket_dir = /tmp
ignore_startup_parameters = extra_float_digits




-------------------------------------------------------------------



Detailed Steps
Add EDB Repository
Run the following command to add the EDB repository:


sudo dnf install -y https://repos.enterprisedb.com/edb-repo-latest.rpm
This command downloads and installs the latest EDB repository configuration for your system.

Install EDB Failover Manager
With the repository added, install EDB Failover Manager using:


sudo dnf install -y edb-efm-4.8
This command will download and install the latest version of EDB Failover Manager 4.8 from the repository.

Verify Installation
After the installation, verify that EDB Failover Manager has been installed correctly by checking the version:


efm --version
Configure EDB Failover Manager
Copy Configuration Files:

Copy the sample configuration files to the configuration directory:


sudo cp /usr/edb/efm-4.8/etc/efm.properties.in /etc/edb/efm-4.8/efm.properties
sudo cp /usr/edb/efm-4.8/etc/efm.nodes.in /etc/edb/efm-4.8/efm.nodes
Edit the Configuration Files:

Edit the efm.properties and efm.nodes files to match your environment. Use an editor such as nano or vi:


sudo nano /etc/edb/efm-4.8/efm.properties
sudo nano /etc/edb/efm-4.8/efm.nodes
Ensure the bind.address, db.user, db.password, and other necessary settings are configured correctly in efm.properties.

Set Proper Permissions:

Ensure the EFM configuration files have the correct permissions:


sudo chmod 600 /etc/edb/efm-4.8/efm.properties
sudo chmod 600 /etc/edb/efm-4.8/efm.nodes
Start and Enable EFM Service
Start the EFM Service:


sudo systemctl start edb-efm-4.8
Enable the EFM Service to Start on Boot:


sudo systemctl enable edb-efm-4.8
Verify EFM Service Status
Check the status of the EFM service to ensure it is running correctly:


sudo systemctl status edb-efm-4.8
Example Configuration
Primary Server (efm.properties):


bind.address = primary-server-ip
db.user = replicator
db.password = your_password
db.port = 5432
db.database = your_database
db.bin = /usr/pgsql-15/bin
db.service.owner = svcpostgres
admin.port = 8001
is.witness = false
ping.server.ip = your_ping_server_ip
efm.loglevel = INFO
Nodes File (efm.nodes):

Add the IP addresses and ports of the primary and standby nodes:


primary-server-ip:7800
standby-server-ip:7800
Summary
By following these steps, you will successfully install and configure the latest version of EDB Failover Manager (EFM) 4.8 on your Oracle Linux Server 8.8. This setup ensures that EFM is properly installed, configured, and set to start on boot, providing high availability and automatic failover for your PostgreSQL clusters.







