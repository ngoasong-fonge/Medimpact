[databases]
db1 = host=1.1.1.1 port=5432 dbname=db1 user=db1_user
db2 = host=1.1.1.1 port=5432 dbname=db2 user=db2_user

[pgbouncer]
listen_addr = 1.1.1.1
listen_port = 3333
auth_type = md5
auth_file = /etc/pgbouncer/userlist.txt
admin_users = admin_user
pool_mode = transaction
max_client_conn = 1000
default_pool_size = 20
logfile = /var/log/pgbouncer/pgbouncer.log
pidfile = /var/log/pgbouncer/pgbouncer.pid
unix_socket_dir = /tmp
ignore_startup_parameters = extra_float_digits


====================================


psql 'host=10.13.102.119 user=repmgr dbname=repmgr connect_timeout=2'

==================================


#!/bin/bash

# Source the environment file
source /opt/app/localhome/postgres/pg_env.sh

# Specify backup file location
backup_location="/opt/backup/overwrite_backup"
log_location="/opt/backup/backup_log.txt"
original_schema="mepstg"  # Replace with your original schema name

# Remove the oldest backup file
oldest_backup=$(ls -t "$backup_location/${original_schema}_backup_"*".sql" | tail -n 1)
if [ -n "$oldest_backup" ]; then
  rm "$oldest_backup"
  #echo "Removed the oldest backup file: $oldest_backup"
fi

# Record the start time
start_time=$(date +"%Y-%m-%d %H:%M:%S")

# Backup the schema without parallelism
timestamp=$(date +"%Y-%m-%d-%H%M%S")
backup_file="$backup_location/${original_schema}_backup_${timestamp}.sql"
pg_dump -h localhost -U deployadmin -d citus -n "$original_schema" --schema="$original_schema" > "$backup_file"

# Check the status of the backup operation
if [ $? -eq 0 ]; then
  echo "Backup completed successfully. Backup file: $backup_file"
else
  echo "Error: Backup operation failed."
fi

# Record the completion time
end_time=$(date +"%Y-%m-%d %H:%M:%S")

# Output the start and completion times to a log file
echo "Start Time: $start_time" > "$log_location"
echo "Completion Time: $end_time" >> "$log_location"

# Display the log file path
echo "Backup completed. Log file: $log_location"


===========

[svcpostgres@uv1medpg3db1 ~]$ sudo -u svcpostgres pg_basebackup -D /opt/backup/basebackup -Ft -z -P -v
pg_basebackup: error: connection to server on socket "/run/postgresql/.s.PGSQL.5432" failed: No such file or directory
        Is the server running locally and accepting connections on that socket?

